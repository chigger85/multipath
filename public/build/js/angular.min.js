angular.module("mainCtrl",["sentenceService"]).controller("mainController",["$location","Sentence","$routeParams",function(a,b,c){var d=this;d.submitted=!1,d.edit=!1,d.origin=!1,d.sentenceData={},d.refresh=function(){b.all().success(function(e){0==e.length?(d.start=!0,d.sentenceData={},d.submitted=!1,d.setOrigin=!0,a.path("/")):!c.sentence_id&&e.length>0?(d.start=!0,d.submitted=!0,d.setOrigin=!1,b.first().success(function(b){d.sentenceData=b[0],d.firstId=b[0]._id,a.path("/"+d.sentenceData._id)})):c.sentence_id==d.firstId?d.start=!0:c.sentence_id&&c.sentence_id!==d.firstId&&(d.start=!1,d.submitted=!0,d.setOrigin=!1,b.get(c.sentence_id).success(function(a){d.sentenceData=a}))})},d.refresh(),d.deleteAll=function(){b.deleteAll().success(function(b){a.path("/"),d.refresh()})},d.addSentence=function(){d.message="",d.sentenceData.start=d.setOrigin,d.sentenceData.origin=null,b.create(d.sentenceData).success(function(a){d.message=a.message,d.sentenceData=a.posted,d.refresh()})},d.editSentence=function(a){d.edit=!0,d.submitted=!1,b.get(a).success(function(a){d.sentenceData=a})},d.updateSentence=function(a,c){b.update(a,c).success(function(a){d.submitted=!0,d.edit=!1,d.refresh()})}}]),angular.module("quadCtrl",["sentenceService"]).controller("quadController",["$scope","Sentence","$routeParams",function(a,b,c){a.submitted=!1,a.edit=!1,a.sentenceData={},a.origin_id=c.sentence_id,a.refresh=function(c){a.quad=c,b.branch(a.origin_id,a.quad).success(function(b){b.length>0&&(a.submitted=!0,a.sentenceData=b[0])})},a.addSentence=function(){a.sentenceData.node=a.quad,a.sentenceData.origin=a.origin_id,a.sentenceData.start=!1,b.create(a.sentenceData).success(function(b){a.message=b.message,a.sentenceData=b.posted,a.submitted=!0})},a.editSentence=function(c){a.submitted=!1,a.edit=!0,b.get(c).success(function(b){a.sentenceData=b})},a.updateSentence=function(){b.update(a.sentenceData._id,a.sentenceData).success(function(b){a.submitted=!0,a.edit=!1})}}]),angular.module("sentenceService",[]).factory("Sentence",["$http",function(a){var b={};return b.get=function(b){return a.get("/api/sentences/"+b)},b.all=function(){return a.get("/api/sentences/all")},b.first=function(){return a.get("/api/sentences/start")},b.create=function(b){return a.post("api/sentences/",b)},b.update=function(b,c){return a.put("/api/sentences/"+b,c)},b["delete"]=function(b){return a["delete"]("/api/sentences/"+b)},b.branch=function(b,c){return a.get("/api/sentences/branch/"+b+"/"+c)},b.deleteAll=function(){return a["delete"]("/api/sentences/all")},b}]),angular.module("userApp",["app.routes","sentenceService","mainCtrl","quadCtrl"]),angular.module("app.routes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"app/views/pages/home.html",controller:"mainController",controllerAs:"mainController as main"}).when("/:sentence_id",{templateUrl:"app/views/pages/story.html",controller:"mainController",controllerAs:"mainController as main"}),b.html5Mode(!0)}]);